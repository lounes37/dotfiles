{{- if eq .chezmoi.os "windows" -}}
# Self-elevate the script if required
if (-Not ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] 'Administrator')) {
  if ([int](Get-CimInstance -Class Win32_OperatingSystem | Select-Object -ExpandProperty BuildNumber) -ge 6000) {
    $CommandLine = "-File `"" + $MyInvocation.MyCommand.Path + "`" " + $MyInvocation.UnboundArguments
    Start-Process -Wait -FilePath PowerShell.exe -Verb Runas -ArgumentList $CommandLine
    Exit
  }
}

# List of software to install
$software = @(
    @{
        Name = "Notion"
        Id = "Notion.Notion"
    },
    @{
        Name = "Firefox"
        Id = "Mozilla.Firefox"
    },
    @{
        Name = "Obsidian"
        Id = "Obsidian.Obsidian"
    },
    @{
        Name = "EarTrumpet"
        Id = "File-New-Project.EarTrumpet"
    },
    @{
        Name = "Notepad++"
        Id = "Notepad++.Notepad++"
    },
        @{
        Name = "Bitwarden"
        Id   = "Bitwarden.Bitwarden"
    },
    @{
        Name = "NotepadsApp"
        Id   = "JackieLiu.NotepadsApp"
    },
    @{
        Name = "Brave Browser"
        Id   = "Brave.Brave"
    },
    @{
        Name = "7zip"
        Id   = "7zip.7zip"
    },
    @{
        Name = "Picocrypt"
        Id   = "EvanSu.Picocrypt"
    },
    @{
        Name = "Everything"
        Id   = "voidtools.Everything"
    },
    @{
        Name = "GitHubDesktop"
        Id   = "GitHub.GitHubDesktop"
    },
    @{
        Name = "Git"
        Id   = "Git.Git"
    },
    @{
        Name = "Logseq"
        Id   = "Logseq.Logseq"
    },
    @{
        Name = "Picard"
        Id   = "MusicBrainz.Picard"
    },
    @{
        Name = "Raindrop"
        Id = "RustemMussabekov.Raindrop"
    },
    @{
        Name = "SumatraPDF"
        Id = "SumatraPDF.SumatraPDF"
    },
    @{
        Name = "Clink"
        Id = "chrisant996.Clink"
    },
    @{
        Name = "foobar2000"
        Id = "PeterPawlowski.foobar2000"
    },
    @{
        Name = "qBittorrent"
        Id = "qBittorrent.qBittorrent"
    },
    @{
        Name = "Espanso"
        Id = "Espanso.Espanso"
    },
    @{
        Name = "Spek"
        Id = "AlexanderKojevnikov.Spek"
    },
    @{
        Name = "PathCopyCopy"
        Id = "CLechasseur.PathCopyCopy"
    },
    @{
        Name = "Alacritty"
        Id = "Alacritty.Alacritty"
    },
    @{
        Name = "SVG Explorer Extension"
        Id = "SVGExplorerExtension.SVGExplorerExtension"
    },
    @{
        Name = "KeePassXC"
        Id = "KeePassXCTeam.KeePassXC"
    },
    @{
        Name = "VLC media player"
        Id = "VideoLAN.VLC"
    },
    @{
        Name = "JPEGView"
        Id = "sylikc.JPEGView"
    },
    @{
        Name = "PowerShell"
        Id = "Microsoft.PowerShell"
    },
    @{
        Name = "WezTerm"
        Id = "wez.wezterm"
    },
    @{
        Name = "Helix"
        Id = "Helix.Helix"
    },
    @{
        Name = "Authme"
        Id = "Levminer.Authme"
    }
)
# Loop through the software list and install each application
foreach ($app in $software) {
    Write-Host "Installing $($app.Name)..."
    winget install --id=$($app.Id) --accept-package-agreements --no-upgrade --accept-source-agreements --disable-interactivity --silent
    if ($?) {
        Write-Host "$($app.Name) installed successfully."
    }
    else {
        Write-Host "Failed to install $($app.Name)." -ForegroundColor Red
    }
}

{{- end }}